<!DOCTYPE html><html class=writer-html5 lang=en> <head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width, initial-scale=1.0"><meta name=author content="Wilfried Guiblet, Ph.D. and Vishal Koparde, Ph.D."><link rel="shortcut icon" href=../../img/favicon.ico><title>Workflow - NCI-RBL Dockers</title><link rel=stylesheet href=../../css/theme.css><link rel=stylesheet href=../../css/theme_extra.css><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css><script>
        // Current page data
        var mkdocs_page_name = "Workflow";
        var mkdocs_page_input_path = "eCLIP/eCLIP_workflow.md";
        var mkdocs_page_url = null;
      </script><!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]--><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js></script><script>hljs.highlightAll();</script></head> <body class=wy-body-for-nav role=document> <div class=wy-grid-for-nav> <nav data-toggle=wy-nav-shift class="wy-nav-side stickynav"> <div class=wy-side-scroll> <div class=wy-side-nav-search> <a href=../.. class="icon icon-home"> NCI-RBL Dockers </a><div role=search> <form id=rtd-search-form class=wy-form action=../../search.html method=get> <input type=text name=q placeholder="Search docs" aria-label="Search docs" title="Type search term here"> </form> </div> </div> <div class="wy-menu wy-menu-vertical" data-spy=affix role=navigation aria-label="Navigation menu"> <ul> <li class=toctree-l1><a class="reference internal" href=../..>Intro</a> </li> </ul> <p class=caption><span class=caption-text>MOP2</span></p> <ul> <li class=toctree-l1><a href=../../MOP2/descript/ class="reference internal">Description</a> </li> <li class=toctree-l1><a href=../../MOP2/init/ class="reference internal">Initialize</a> </li> <li class=toctree-l1><a href=../../MOP2/run/ class="reference internal">Run</a> </li> </ul> <p class=caption><span class=caption-text>DTEG</span></p> <ul> <li class=toctree-l1><a href=../../DTEG/descript/ class="reference internal">Description</a> </li> <li class=toctree-l1><a href=../../DTEG/init/ class="reference internal">Initialize</a> </li> <li class=toctree-l1><a href=../../DTEG/run/ class="reference internal">Run</a> </li> </ul> <p class=caption><span class=caption-text>ISOMIR</span></p> <ul> <li class=toctree-l1><a href=../../ISOMIR/descript/ class="reference internal">Description</a> </li> <li class=toctree-l1><a href=../../ISOMIR/init/ class="reference internal">Initialize</a> </li> <li class=toctree-l1><a href=../../ISOMIR/run/ class="reference internal">Run</a> </li> </ul> <p class=caption><span class=caption-text>RiboFootPrint</span></p> <ul> <li class=toctree-l1><a href=../../RiboFootPrint/descript/ class="reference internal">Description</a> </li> <li class=toctree-l1><a href=../../RiboFootPrint/init/ class="reference internal">Initialize</a> </li> <li class=toctree-l1><a href=../../RiboFootPrint/run/ class="reference internal">Run</a> </li> </ul> <p class=caption><span class=caption-text>iCLIP</span></p> <ul> <li class=toctree-l1><a href=../../iCLIP/descript/ class="reference internal">Description</a> </li> <li class=toctree-l1><a href=../../iCLIP/init/ class="reference internal">Initialize</a> </li> <li class=toctree-l1><a href=../../iCLIP/run/ class="reference internal">Run</a> </li> </ul> <p class=caption><span class=caption-text>eCLIP</span></p> <ul class=current> <li class="toctree-l1 current"><a class="reference internal current" href=#>Workflow</a> <ul class=current> <li class=toctree-l2><a class="reference internal" href=#setting-up-eclip-workflow>Setting Up eCLIP Workflow</a> <ul> <li class=toctree-l3><a class="reference internal" href=#create-an-environment-to-run-eclip-workflow-on-frce>Create an Environment to Run eCLIP Workflow on FRCE</a> </li> <li class=toctree-l3><a class="reference internal" href=#download-yeo-labs-github-repository>Download Yeo Lab's GitHub Repository</a> </li> <li class=toctree-l3><a class="reference internal" href=#download-custom-scripts-to-run-the-pipeline-on-biowulf-frce>Download custom scripts to run the pipeline on biowulf / FRCE</a> </li> <li class=toctree-l3><a class="reference internal" href=#setting-up-required-files-and-directories>Setting Up Required Files and Directories</a> </li> <li class=toctree-l3><a class="reference internal" href=#modify-the-run-script>Modify the Run Script</a> </li> </ul> </li> <li class=toctree-l2><a class="reference internal" href=#running-workflow>Running Workflow</a> </li> <li class=toctree-l2><a class="reference internal" href=#results>Results</a> </li> </ul> </li> </ul> <p class=caption><span class=caption-text>LEAFCUTTER</span></p> <ul> <li class=toctree-l1><a href=../../LEAFCUTTER/descript/ class="reference internal">Description</a> </li> <li class=toctree-l1><a href=../../LEAFCUTTER/init/ class="reference internal">Initialize</a> </li> <li class=toctree-l1><a href=../../LEAFCUTTER/run/ class="reference internal">Run</a> </li> </ul> </div> </div> </nav> <section data-toggle=wy-nav-shift class=wy-nav-content-wrap> <nav class=wy-nav-top role=navigation aria-label="Mobile navigation menu"> <i data-toggle=wy-nav-top class="fa fa-bars"></i> <a href=../..>NCI-RBL Dockers</a> </nav> <div class=wy-nav-content> <div class=rst-content><div role=navigation aria-label="breadcrumbs navigation"> <ul class=wy-breadcrumbs> <li><a href=../.. class="icon icon-home" aria-label=Docs></a></li> <li class=breadcrumb-item>eCLIP</li> <li class="breadcrumb-item active">Workflow</li> <li class=wy-breadcrumbs-aside> <a href=https://github.com/NCI-RBL/Dockers/edit/main/docs/eCLIP/eCLIP_workflow.md>Edit on NCI-RBL/Dockers</a> </li> </ul> <hr> </div> <div role=main class=document itemscope=itemscope itemtype=http://schema.org/Article> <div class=section itemprop=articleBody> <h1 id=eclip-workflow>eCLIP Workflow<a class=headerlink href=#eclip-workflow title="Permanent link">&para;</a></h1> <p>The eCLIP Workflow implemented here was designed to run on a High-performance Cluster such as <strong><em>Biowulf</em></strong> or <strong><em>FRCE</em></strong>. The heart of the workflow analysis uses the <strong><em>eCLIP</em></strong> workflow from Yeo Lab's.</p> <p>Detailed information on required software can be found using the following links:</p> <ol> <li><a href=https://slurm.schedmd.com>Slurm workload Manager</a></li> <li><a href=https://modules.readthedocs.io/en/latest/ >Environmental Modules</a></li> <li><a href=https://sylabs.io/singularity/ >SingularityCE</a></li> <li><a href=https://git-scm.com>git</a></li> <li><a href=https://github.com/YeoLab/eCLIP>eCLIP</a> from Yeo Lab.</li> <li><a href=https://seqera.io/multiqc/ >MultiQC</a> from Seqera.</li> </ol> <p>The first four items are typically provided by a High-performance Cluster such as <strong><em>Biowulf</em></strong> or <strong><em>FRCE</em></strong>.</p> <h2 id=setting-up-eclip-workflow>Setting Up eCLIP Workflow<a class=headerlink href=#setting-up-eclip-workflow title="Permanent link">&para;</a></h2> <h3 id=create-an-environment-to-run-eclip-workflow-on-frce>Create an Environment to Run eCLIP Workflow on FRCE<a class=headerlink href=#create-an-environment-to-run-eclip-workflow-on-frce title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code>module<span class=w> </span>load<span class=w> </span>mamba

mamba<span class=w> </span>create<span class=w> </span>-n<span class=w> </span>cwl_env<span class=w> </span>conda-forge::tabulate<span class=w> </span>conda-forge::cwltool<span class=w> </span>matplotlib

mamba<span class=w> </span>activate<span class=w> </span>cwl_env
pip<span class=w> </span>install<span class=w> </span>multiqc

multiqc<span class=w> </span>--version
</code></pre></div> <h3 id=download-yeo-labs-github-repository>Download Yeo Lab's GitHub Repository<a class=headerlink href=#download-yeo-labs-github-repository title="Permanent link">&para;</a></h3> <div class=highlight><pre><span></span><code><span class=nv>SCRIPT_DIR</span><span class=o>=</span>/home/<span class=nv>$USER</span>/eCLIP_WF
mkdir<span class=w> </span><span class=nv>$SCRIPT_DIR</span>

<span class=nb>cd</span><span class=w> </span><span class=nv>$SCRIPT_DIR</span>
git<span class=w> </span>clone<span class=w> </span>git@github.com:YeoLab/eCLIP.git

<span class=nv>ECLIP_DIR</span><span class=o>=</span><span class=nv>$SCRIPT_DIR</span>/eCLIP
ls<span class=w> </span>-l<span class=w> </span><span class=nv>$ECLIP_DIR</span>
</code></pre></div> <h3 id=download-custom-scripts-to-run-the-pipeline-on-biowulf-frce>Download custom scripts to run the pipeline on biowulf / FRCE<a class=headerlink href=#download-custom-scripts-to-run-the-pipeline-on-biowulf-frce title="Permanent link">&para;</a></h3> <ol> <li><a href=https://github.com/NCI-RBL/Dockers/blob/main/workflows/eCLIP/src/env.yml>env.yml</a></li> <li><a href=https://github.com/NCI-RBL/Dockers/blob/main/workflows/eCLIP/src/post_process_eCLIP.py>post_process_eCLIP.py</a></li> <li><a href=https://github.com/NCI-RBL/Dockers/blob/main/workflows/eCLIP/src/run.sh>run.sh</a></li> <li><a href=https://github.com/NCI-RBL/Dockers/blob/main/workflows/eCLIP/src/summarize_merge_peaks_wf.py>summarize_merge_peaks_wf.py</a></li> </ol> <h3 id=setting-up-required-files-and-directories>Setting Up Required Files and Directories<a class=headerlink href=#setting-up-required-files-and-directories title="Permanent link">&para;</a></h3> <p>Directory locations should be based on the preferences of the user. As an example, we provide the following set up below as set up on FRCE. It is recommend that you separate the results or runs directory from the data directory. A full description of required files is located with links below:</p> <ul> <li><a href="https://github.com/YeoLab/eCLIP?tab=readme-ov-file#prerequisite-files">Prerequisite files</a></li> <li><a href="https://github.com/YeoLab/eCLIP?tab=readme-ov-file#description-of-the-manifest">Description of the manifest File</a></li> </ul> <div class=highlight><pre><span></span><code><span class=nv>DATA_DIR</span><span class=o>=</span>/home/<span class=nv>$USER</span>/Data
<span class=nv>RUN_DIR</span><span class=o>=</span>/scratch/cluster_scratch/<span class=nv>$USER</span>/eCLIP_run

mkdir<span class=w> </span><span class=nv>$DATA_DIR</span>
mkdir<span class=w> </span><span class=nv>$RUN_DIR</span>
</code></pre></div> <p>Create a manifest directory and manifest file as required by eCLIP.</p> <div class=highlight><pre><span></span><code><span class=nv>MANIFEST_DIR</span><span class=o>=</span><span class=nv>$DATA_DIR</span>/manifests
mkdir<span class=w> </span><span class=nv>$MANIFEST_DIR</span>

<span class=c1># For single-end reads copy, modify and rename file</span>
cp<span class=w> </span><span class=nv>$ECLIP_DIR</span>/example/single_end_clip.yaml<span class=w> </span><span class=nv>$MANIFEST_DIR</span>/
</code></pre></div> <h3 id=modify-the-run-script>Modify the Run Script<a class=headerlink href=#modify-the-run-script title="Permanent link">&para;</a></h3> <p>Modify the run.sh script file.</p> <h2 id=running-workflow>Running Workflow<a class=headerlink href=#running-workflow title="Permanent link">&para;</a></h2> <p>The workflow has two major parts:</p> <ol> <li>Run YeoLab's <a href=https://github.com/YeoLab/eCLIP>eCLIP</a>.</li> <li>Followed by YeoLab's <a href=https://github.com/YeoLab/merge_peaks>merge_peaks</a></li> </ol> <div class=highlight><pre><span></span><code>sbatch<span class=w> </span>run.sh
</code></pre></div> <h2 id=results>Results<a class=headerlink href=#results title="Permanent link">&para;</a></h2> <p>A full description of results files are located with <a href="https://github.com/YeoLab/eCLIP?tab=readme-ov-file#outputs">eCLIP Outputs</a> and <a href="https://github.com/YeoLab/merge_peaks?tab=readme-ov-file#outputs">merge_peaks Outputs</a>.</p> <p>We provide two summary html files are generated:</p> <ol> <li><strong><em>eCLIP_ReadMeSummary.html</em></strong> summary results file as a starting point for exploration of your results of <strong><em>eCLIP</em></strong>, and</li> <li><strong><em>eCLIP_MergePeaks_ReadMeSummary.html</em></strong> for <strong><em>merge_peaks</em></strong>.</li> </ol> </div> </div><script async src="https://www.googletagmanager.com/gtag/js?id=G-D3SL9V30KL"></script> <script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-D3SL9V30KL'); // Replace with your tracking ID
</script> </div> </div> </section> </div> <div class=rst-versions role=note aria-label=Versions> <span class=rst-current-version data-toggle=rst-current-version> <span> <a href=https://github.com/NCI-RBL/Dockers class="fa fa-code-fork" style="color: #fcfcfc"> NCI-RBL/Dockers</a> </span> <span><a href=../../iCLIP/run/ style="color: #fcfcfc">&laquo; Previous</a></span> <span><a href=../../LEAFCUTTER/descript/ style="color: #fcfcfc">Next &raquo;</a></span> </span> </div> <script src=../../js/jquery-3.6.0.min.js></script> <script>var base_url = "../..";</script> <script src=../../js/theme_extra.js></script> <script src=../../js/theme.js></script> <script src=../../search/main.js></script> <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script> </body> </html> 